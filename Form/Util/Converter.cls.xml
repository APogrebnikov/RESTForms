<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="Form.Util.Converter">
<Description>
Various datatype conversion utilities</Description>
<Abstract>1</Abstract>
<TimeCreated>64100,82956.192829</TimeCreated>

<Method name="stringToArray">
<Description>
Convert delimited string to dynamic array</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>string:%String,delimiter:%String=","</FormalSpec>
<ReturnType>%Array</ReturnType>
<Implementation><![CDATA[
	set list = $listFromString(string, delimiter)
	return ..listToArray(list)
]]></Implementation>
</Method>

<Method name="listToArray">
<Description>
Convert $list to dynamic array</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>list:%List</FormalSpec>
<ReturnType>%Array</ReturnType>
<Implementation><![CDATA[
	set array = []
	set pointer = 0
	while $listNext(list, pointer, piece) {
		do array.$push(piece)
	}
	return array
]]></Implementation>
</Method>

<Method name="sqlTypeToClass">
<Description>
TODO. Populate on install?</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>type:%Integer=""</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	if type = 2 {
		set result = "%Library.Date"
	} elseif type = 9 {
		set result = "%Library.TimeStamp"
	} else {
		set result = ""
	}
	return result
]]></Implementation>
</Method>

<Method name="logicalToJSON">
<ClassMethod>1</ClassMethod>
<FormalSpec>datatype:%String="",value:%String</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	return:datatype="" value
	if datatype = "%Library.Date" {
		set result = ##class(%Date).LogicalToXSD(value)
	} elseif datatype = "%Library.TimeStamp" {
		set result = ##class(%TimeStamp).LogicalToXSD(value)
	} else {
		set result = value
	}
	return result
]]></Implementation>
</Method>

<Method name="jsonToLogical">
<ClassMethod>1</ClassMethod>
<FormalSpec>datatype:%String="",value:%String</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	return:datatype="" value
	if datatype = "%Library.Date" {
		set result = ##class(%Date).XSDToLogical(value)
	} elseif datatype = "%Library.TimeStamp" {
		set result = ##class(%TimeStamp).XSDToLogical(value)
	} else {
		set result = value
	}
	return result
]]></Implementation>
</Method>
</Class>
</Export>
